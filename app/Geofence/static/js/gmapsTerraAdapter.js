!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("terra-draw")):"function"==typeof define&&define.amd?define(["exports","terra-draw"],t):t((e||self).terraDrawGoogleMapsAdapter={},e.terraDraw)}(this,function(e,t){function r(e,t){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},r(e,t)}function o(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}e.TerraDrawGoogleMapsAdapter=/*#__PURE__*/function(e){function t(t){var r;return(r=e.call(this,t)||this)._cursor=void 0,r._cursorStyleSheet=void 0,r._lib=void 0,r._map=void 0,r._overlay=void 0,r._clickEventListener=void 0,r._mouseMoveEventListener=void 0,r._readyCalled=!1,r.renderedFeatureIds=new Set,r._lib=t.lib,r._map=t.map,r._coordinatePrecision="number"==typeof t.coordinatePrecision?t.coordinatePrecision:9,r}var n,i;i=e,(n=t).prototype=Object.create(i.prototype),n.prototype.constructor=n,r(n,i);var a,l,s=t.prototype;return s.circlePath=function(e,t,r){var o=2*r;return"M "+e+" "+t+" m -"+r+", 0 a "+r+","+r+" 0 1,0 "+o+",0 a "+r+","+r+" 0 1,0 -"+o+",0"},s.register=function(t){var r=this;e.prototype.register.call(this,t),this._overlay=new this._lib.OverlayView,this._overlay.draw=function(){},this._overlay.onAdd=function(){var e;null!=(e=r._currentModeCallbacks)&&e.onReady&&!r._readyCalled&&(r._currentModeCallbacks.onReady(),r._readyCalled=!0)},this._overlay.setMap(this._map),this._overlay.onRemove=function(){},this._clickEventListener=this._map.data.addListener("click",function(e){var t=r._listeners.find(function(e){return"click"===e.name});t&&t.callback(e)}),this._mouseMoveEventListener=this._map.data.addListener("mousemove",function(e){var t=r._listeners.find(function(e){return"mousemove"===e.name});t&&t.callback(e)})},s.unregister=function(){var t,r;e.prototype.unregister.call(this),null==(t=this._clickEventListener)||t.remove(),null==(r=this._mouseMoveEventListener)||r.remove(),this._overlay&&this._overlay.getMap()&&this._overlay.setMap(null),this._overlay=void 0,this._readyCalled=!1},s.getLngLatFromEvent=function(e){if(!this._overlay)throw new Error("cannot get overlay");var t=this._map.getBounds();if(!t)return null;var r=t.getNorthEast(),o=t.getSouthWest(),n=new this._lib.LatLngBounds(o,r),i=this._map.getDiv(),a=e.clientX-i.getBoundingClientRect().left,l=e.clientY-i.getBoundingClientRect().top,s=new this._lib.Point(a,l),c=this._overlay.getProjection();if(!c)return null;var d=c.fromContainerPixelToLatLng(s);return d&&n.contains(d)?{lng:d.lng(),lat:d.lat()}:null},s.getMapEventElement=function(){return this._map.getDiv().querySelector('div[style*="z-index: 3;"]')},s.project=function(e,t){if(!this._overlay)throw new Error("cannot get overlay");if(void 0===this._map.getBounds())throw new Error("cannot get bounds");var r=this._overlay.getProjection();if(void 0===r)throw new Error("cannot get projection");var o=r.fromLatLngToContainerPixel(new this._lib.LatLng(t,e));if(null===o)throw new Error("cannot project coordinates");return{x:o.x,y:o.y}},s.unproject=function(e,t){if(!this._overlay)throw new Error("cannot get overlay");var r=this._overlay.getProjection();if(void 0===r)throw new Error("cannot get projection");var o=r.fromContainerPixelToLatLng(new this._lib.Point(e,t));if(null===o)throw new Error("cannot unproject coordinates");return{lng:o.lng(),lat:o.lat()}},s.setCursor=function(e){if(e!==this._cursor){if(this._cursorStyleSheet&&(this._cursorStyleSheet.remove(),this._cursorStyleSheet=void 0),"unset"!==e){var t=this._map.getDiv().querySelector(".gm-style > div");if(t){t.classList.add("terra-draw-google-maps");var r=document.createElement("style");r.innerHTML=".terra-draw-google-maps { cursor: "+e+" !important; }",document.getElementsByTagName("head")[0].appendChild(r),this._cursorStyleSheet=r}}this._cursor=e}},s.setDoubleClickToZoom=function(e){this._map.setOptions(e?{disableDoubleClickZoom:!1}:{disableDoubleClickZoom:!0})},s.setDraggability=function(e){this._map.setOptions({draggable:e})},s.render=function(e,t){var r=this;this._layers&&(e.deletedIds.forEach(function(e){var t=r._map.data.getFeatureById(e);t&&(r._map.data.remove(t),r.renderedFeatureIds.delete(e))}),e.updated.forEach(function(e){if(!e||!e.id)throw new Error("Feature is not valid");var t=r._map.data.getFeatureById(e.id);if(!t)throw new Error("Feature could not be found by Google Maps API");switch(t.forEachProperty(function(e,r){t.setProperty(r,void 0)}),Object.keys(e.properties).forEach(function(r){t.setProperty(r,e.properties[r])}),e.geometry.type){case"Point":var o=e.geometry.coordinates;t.setGeometry(new r._lib.Data.Point(new r._lib.LatLng(o[1],o[0])));break;case"LineString":for(var n=e.geometry.coordinates,i=[],a=0;a<n.length;a++){var l=n[a],s=new r._lib.LatLng(l[1],l[0]);i.push(s)}t.setGeometry(new r._lib.Data.LineString(i));break;case"Polygon":for(var c=e.geometry.coordinates,d=[],u=0;u<c.length;u++){for(var h=[],p=0;p<c[u].length;p++){var y=new r._lib.LatLng(c[u][p][1],c[u][p][0]);h.push(y)}d.push(h)}t.setGeometry(new r._lib.Data.Polygon(d))}}),e.created.forEach(function(e){r.renderedFeatureIds.add(e.id),r._map.data.addGeoJson(e)})),e.created.forEach(function(e){r.renderedFeatureIds.add(e.id)});var o={type:"FeatureCollection",features:[].concat(e.created)};this._map.data.addGeoJson(o),this._map.data.setStyle(function(e){var o=e.getProperty("mode"),n=e.getGeometry();if(!n)throw new Error("Google Maps geometry not found");var i=n.getType(),a={},l=e.getId();e.forEachProperty(function(e,t){a[t]=e});var s=t[o]({type:"Feature",id:l,geometry:{type:i,coordinates:[]},properties:a});switch(i){case"Point":return s.markerUrl?{clickable:!1,icon:{url:s.markerUrl,scaledSize:s.markerWidth&&s.markerHeight?new r._lib.Size(s.markerWidth,s.markerHeight):void 0},zIndex:s.zIndex}:{clickable:!1,icon:{path:r.circlePath(0,0,s.pointWidth),fillColor:s.pointColor,fillOpacity:1,strokeColor:s.pointOutlineColor,strokeWeight:s.pointOutlineWidth,rotation:0,scale:1},zIndex:s.zIndex};case"LineString":return{strokeColor:s.lineStringColor,strokeWeight:s.lineStringWidth,zIndex:s.zIndex};case"Polygon":return{strokeColor:s.polygonOutlineColor,strokeWeight:s.polygonOutlineWidth,fillOpacity:s.polygonFillOpacity,fillColor:s.polygonFillColor,zIndex:s.zIndex}}throw Error("Unknown feature type")})},s.clearLayers=function(){var e=this;this._layers&&(this._map.data.forEach(function(t){var r=t.getId();e.renderedFeatureIds.has(r)&&e._map.data.remove(t)}),this.renderedFeatureIds=new Set)},s.clear=function(){this._currentModeCallbacks&&(this._currentModeCallbacks.onClear(),this.clearLayers())},s.getCoordinatePrecision=function(){return e.prototype.getCoordinatePrecision.call(this)},a=t,(l=[{key:"_layers",get:function(){var e;return Boolean((null==(e=this.renderedFeatureIds)?void 0:e.size)>0)}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,o(n.key),n)}}(a.prototype,l),Object.defineProperty(a,"prototype",{writable:!1}),a}(t.TerraDrawExtend.TerraDrawBaseAdapter)});
//# sourceMappingURL=terra-draw-google-maps-adapter.umd.js.map