{%extends "base.html"%}

{% block head %}
<title>Geofence</title>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="stylesheet" href="{{ url_for('Geofence.static', filename='css/geofence.css') }}" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
<script defer src="{{ url_for('Geofence.static', filename='js/geofence.js') }}"></script>
{% endblock %}

{% block h1 %}
Create Geofence
{% endblock %}

{% block block_container %}
<div class="map-container">
    <div id="map"></div>
    <div class="controls">
        <button id="drawPolygonBtn" class="btn primary">Draw Polygon</button>
        <button id="drawCircleBtn" class="btn primary">Draw Circle</button>
        <button id="clearShapesBtn" class="btn danger">Clear Shapes</button>
        <button id="saveGeofenceBtn" class="btn success">Save Geofence</button>
    </div>
</div>
<div id="geofenceList" class="geofence-list">
    <h3>Saved Geofences</h3>
    <ul id="geofencesUl">
        <!-- Geofence items will be populated here -->
    </ul>
</div>
<!-- Modal Popup for Geofence Details -->
<div class="geofence-modal hidden" id="geofenceModal">
    <div class="geofence-modal-content">
        <span class="geofence-close-btn" id="closeGeofenceModal">&times;</span>
        <h2 style="margin-bottom: 10px;">Geofence Details</h2>
        <form id="geofenceForm" action="{{ url_for('Geofence.save_geofence') }}" method="post" enctype="multipart/form-data">
            <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
            <input type="hidden" name="shapeData" id="shapeData" />
            <div class="form-container">
                <div class="form-group">
                    <label for="GeofenceName">Geofence Name<span style="size: 12px; color: red;">*</span></label>
                    <input type="text" name="GeofenceName" id="GeofenceName" required />
                    <div id="geofenceNameError" class="error hidden">Geofence Name is required.</div>
                </div>
                <div class="form-group">
                    <label for="Description">Description</label>
                    <textarea name="Description" id="Description" rows="3"></textarea>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn success">Save Geofence</button>
                    <button type="button" id="cancelGeofenceBtn" class="btn danger">Cancel</button>
                </div>
            </div>
        </form>
    </div>
</div>
<div id="errorBox" class="error-box hidden"></div>
{% endblock %}