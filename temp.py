imeis = [
'863070045822250', '863070045822607', '863070045833273', '863070045841771', '863070045841862','863070045842142', 
'863070045860201', '863070045860276', '863070045860540', '863070045861472', '863070045864187', 
'863070045864898', '863070045876348', '863070045885885', '863070045916557', '863070045917290', '863070046374319', 
'863070046391735', '863070046393434', '863070046408570', '863070046409420', '863070046468418', '863070047044630', '863070047045058',
'863070047045066', '863070047045157', '863070047045728', '863070047046569', '863070047047674', '863070047056063', 
'863070047056154', '863070047056212', '863070047056253', '863070047057186', '863070047057517', '863070047057541', 
'863070047057814', '863070047057822', '863070047057905', '863070047057988', '863070047059489', '863070047066195', 
'863070047067284', '863070047069769', '863070047069926', '863070047070049', '863070047070205', '863070047075337', 
'863070047076236', '863070047079354', '863070047079990', '863070047080071', '863070047080196', '863070047080360', '863070047080386', 
'863070047080394', '863070047083182', '863070047094023', '863070047107148', '864326061160622', '864326061161380', 
'864326061161430', '864326061161521', '864326061161570', '864326061161646', '864326061161984', '864326061162222', '864326061162461', 
'864326061162727', '864326061162784', '864326061162917', '864326061162941', '864326061163121', '864326061163618', 
'864326061163774', '864326061163824', '864326061164186', '864326061164327', '864326061166850', '864326061166934', 
'864326061166983', '864326061168682', '864326061168906', '864326061169656', '864326061169995', '864326061176628', '864326061208439', 
'864326061208488', '864326061217877', '864326061218065', '864326061218081', '864326061218370', '864326061218933', 
'864326061219709', '864326061227645', '864326061228031', '864326061234070', '864326061234674', '864326061234724', 
'864326061234815', '864326061234997', '864326061235036', '864326061235267', '864326061235598', '864326061236307', '864326061236505', 
'864326061236562', '864326061236919', '864326061236950', '864326061237248', '864326061237461', '864326061237560', 
'864326061237933', '864326061239905', '864326061239954', '864326061240085', '864326061240119', '864326061240218', 
'864326061240473', '864326061240580', '864326061240614', '864326061240697', '864326061240762', '864326061245225', '864326061245365',
'864326061245399', '864326061245464', '864326061245530', '864326061245589', '864326061245597', '864326061245639', 
'864326061245654', '864326061245688', '864326061246686', '864326061247064', '864326061247098', '864326061247114', 
'864326061247189', '864326061247197', '864326061247239', '864326061247361', '864326061247429', '864326061250506', 
'864326061250530','864326061252940', '864326061255190', '864326061255448', '864326061256180', '864326061256255', '864326061256297', 
'864326061256438', '864326061256446', '864326061256636', '864326061256644', '864326061256677', '864326061256701', 
'864326061256719', '864326061256800', '866777072827658', '868613060209161', '868613060211027', '868613060214849', 
'868613060216521', '868613060220697', '868613060248326', '868613060283802', '868613060320950']

from pymongo import MongoClient

from pymongo import MongoClient
from config import config

mongo_client = MongoClient("mongodb+srv://doadmin:4T81NSqj572g3o9f@db-mongodb-blr1-27716-c2bd0cae.mongo.ondigitalocean.com/admin?tls=true&authSource=admin", tz_aware=True)
db = mongo_client["nnx"]

atlanta_collection = db["atlanta"]
atlantaLatestCollection = db["atlantaLatest"]
collection = db['distinctAtlanta']
distance_travelled_collection = db['distanceTravelled']
vehicle_inventory = db["vehicle_inventory"]
atlantaAis140Collection = db["atlantaAis140"]
atlantaAis140LatestCollection = db["atlantaAis140_latest"]

print(len(imeis))
latest_records = list(atlantaLatestCollection.find({"_id": {"$in": imeis}}))

imeisss = [record['_id'] for record in latest_records]

atlantaAis140Records = list(atlantaAis140LatestCollection.find({"_id": {"$in": imeis}}))
print(f"Total latest records fetched: {len(latest_records) + len(atlantaAis140Records)}")

atlantaImeis = db['atlanta'].distinct('imei')
ais140Imeis = db['atlantaAis140'].distinct('imei')
combinedImeis = set(atlantaImeis) | set(ais140Imeis)
if imeis:
    ssd = [i for i in imeis if i in combinedImeis]
    
print(f"Total IMEIs in combined collection: {len(ssd)}")

for doc in atlantaAis140Records:
    imeisss.append(doc['_id'])
    
for imei in imeis:
    if imei not in imeisss:
        print(f"Missing IMEI: {imei}")